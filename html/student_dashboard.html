<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å­¦ç”Ÿé¦–é¡µ - ä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„çš„åœ¨çº¿è¯¾ç¨‹ç®¡ç†ç³»ç»Ÿ</title>
  <!-- å¼•å…¥Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- å¼•å…¥FontAwesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- å¼•å…¥è‡ªå®šä¹‰æ ·å¼ -->
  <link rel="stylesheet" href="../assets/css/style.css">
  
  <!-- å¼•å…¥åç«¯æœåŠ¡ -->
  <script src="../assets/js/backend.js"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#4361ee',
            secondary: '#3a0ca3',
            success: '#4cc9f0',
            warning: '#f72585',
            danger: '#ff0054',
            'text-primary': '#2b2d42',
            'text-secondary': '#8d99ae',
            'bg-light': '#edf2f4',
          },
          fontFamily: {
            sans: ['Segoe UI', 'Tahoma', 'Geneva', 'Verdana', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .dashboard-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .dashboard-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.1);
      }
      .progress-circle {
        position: relative;
        width: 100px;
        height: 100px;
      }
      .progress-circle svg {
        transform: rotate(-90deg);
      }
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <nav class="bg-white shadow-md">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <!-- å·¦ä¾§Logoå’Œåç§° -->
        <div class="flex items-center">
          <a href="#" class="flex-shrink-0 flex items-center">
            <i class="fa fa-graduation-cap text-primary text-2xl mr-2"></i>
            <span class="font-bold text-lg text-primary">å­¦ä¹ è·¯å¾„ç³»ç»Ÿ</span>
          </a>
          
          <!-- å¯¼èˆªé“¾æ¥ - ä¸­ç­‰å±å¹•ä»¥ä¸Šæ˜¾ç¤º -->
          <div class="hidden md:ml-10 md:flex md:space-x-8">
            <a href="student_dashboard.html" class="border-primary text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
              <i class="fa fa-home mr-2"></i>
              é¦–é¡µ
            </a>
            <a href="courses.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
              <i class="fa fa-book mr-2"></i>
              æˆ‘çš„è¯¾ç¨‹
            </a>
            <a href="assignments.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
              <i class="fa fa-file-text mr-2"></i>
              ä½œä¸šä¸­å¿ƒ
            </a>
            <a href="grades.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
              <i class="fa fa-graduation-cap mr-2"></i>
              æˆç»©æŸ¥è¯¢
            </a>
          </div>
        </div>
        
        <!-- å³ä¾§ç”¨æˆ·ä¿¡æ¯å’Œæ“ä½œ -->
        <div class="flex items-center">
          <!-- æœç´¢æ¡† -->
          <div class="hidden md:block">
            <div class="ml-3 relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fa fa-search text-gray-400"></i>
              </div>
              <input class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md text-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary" placeholder="æœç´¢è¯¾ç¨‹ã€ä½œä¸š...">
            </div>
          </div>
          
          <!-- é€šçŸ¥å›¾æ ‡ -->
          <div class="ml-3 relative">
            <button class="text-gray-500 hover:text-gray-700 focus:outline-none">
              <i class="fa fa-bell text-xl"></i>
              <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">3</span>
            </button>
          </div>
          
          <!-- æ™ºèƒ½åŠ©æ‰‹ -->
          <div class="ml-3 relative">
            <button class="chat-bot-button text-gray-500 hover:text-gray-700 focus:outline-none">
              <i class="fa fa-robot text-xl text-primary"></i>
            </button>
          </div>
          
          <!-- ç”¨æˆ·å¤´åƒ -->
          <div class="ml-3 relative">
            <div class="flex items-center">
              <img class="h-8 w-8 rounded-full object-cover" src="https://picsum.photos/id/64/200/200" alt="ç”¨æˆ·å¤´åƒ">
              <span class="ml-2 text-sm font-medium text-gray-700">å¼ åŒå­¦</span>
              <i class="fa fa-chevron-down ml-1 text-xs text-gray-500"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- ä¸»å†…å®¹åŒº -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <!-- æ¬¢è¿ä¿¡æ¯ -->
    <div class="mb-8">
      <h1 class="text-2xl font-bold text-gray-900">ä½ å¥½ï¼Œå¼ åŒå­¦ï¼ğŸ‘‹</h1>
      <p class="text-gray-600 mt-1">ä»Šå¤©æ˜¯æ˜ŸæœŸä¸‰ï¼Œç»§ç»­åŠ æ²¹å­¦ä¹ å§ï¼</p>
    </div>
    
    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <!-- è¯¾ç¨‹æ€»æ•° -->
      <div class="dashboard-card bg-white overflow-hidden shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0 bg-blue-500 rounded-md p-3">
              <i class="fa fa-book text-white text-xl"></i>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">è¯¾ç¨‹æ€»æ•°</dt>
                <dd>
                  <div class="text-lg font-semibold text-gray-900">8</div>
                </dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
      
      <!-- è¿›è¡Œä¸­è¯¾ç¨‹ -->
      <div class="dashboard-card bg-white overflow-hidden shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0 bg-green-500 rounded-md p-3">
              <i class="fa fa-spinner text-white text-xl"></i>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">è¿›è¡Œä¸­è¯¾ç¨‹</dt>
                <dd>
                  <div class="text-lg font-semibold text-gray-900">5</div>
                </dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
      
      <!-- å¾…å®Œæˆä½œä¸š -->
      <div class="dashboard-card bg-white overflow-hidden shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0 bg-yellow-500 rounded-md p-3">
              <i class="fa fa-file-text text-white text-xl"></i>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">å¾…å®Œæˆä½œä¸š</dt>
                <dd>
                  <div class="text-lg font-semibold text-gray-900">3</div>
                </dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
      
      <!-- å¹³å‡æˆç»© -->
      <div class="dashboard-card bg-white overflow-hidden shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0 bg-purple-500 rounded-md p-3">
              <i class="fa fa-trophy text-white text-xl"></i>
            </div>
            <div class="ml-5 w-0 flex-1">
              <dl>
                <dt class="text-sm font-medium text-gray-500 truncate">å¹³å‡æˆç»©</dt>
                <dd>
                  <div class="text-lg font-semibold text-gray-900">87.5</div>
                </dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- ä¸»è¦å†…å®¹ç½‘æ ¼ -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- å·¦ä¾§ï¼šå­¦ä¹ è¿›åº¦å’Œæ¨è -->
      <div class="lg:col-span-2 space-y-6">
        <!-- å­¦ä¹ è¿›åº¦æ¦‚è§ˆ -->
        <div class="bg-white shadow rounded-lg overflow-hidden">
          <div class="px-4 py-5 border-b border-gray-200 sm:px-6">
            <h3 class="text-lg leading-6 font-medium text-gray-900 flex items-center">
              <i class="fa fa-line-chart text-primary mr-2"></i>
              å­¦ä¹ è¿›åº¦æ¦‚è§ˆ
            </h3>
          </div>
          <div class="px-4 py-5 sm:p-6">
            <div class="space-y-6">
              <!-- é«˜ç­‰æ•°å­¦ -->
              <div>
                <div class="flex justify-between items-center mb-2">
                  <span class="font-medium text-gray-700">é«˜ç­‰æ•°å­¦</span>
                  <span class="text-sm text-gray-500">68%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                  <div class="bg-blue-600 h-2.5 rounded-full" style="width: 68%"></div>
                </div>
              </div>
              
              <!-- çº¿æ€§ä»£æ•° -->
              <div>
                <div class="flex justify-between items-center mb-2">
                  <span class="font-medium text-gray-700">çº¿æ€§ä»£æ•°</span>
                  <span class="text-sm text-gray-500">42%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                  <div class="bg-green-600 h-2.5 rounded-full" style="width: 42%"></div>
                </div>
              </div>
              
              <!-- æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ -->
              <div>
                <div class="flex justify-between items-center mb-2">
                  <span class="font-medium text-gray-700">æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡</span>
                  <span class="text-sm text-gray-500">85%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                  <div class="bg-purple-600 h-2.5 rounded-full" style="width: 85%"></div>
                </div>
              </div>
              
              <!-- è®¡ç®—æœºåŸºç¡€ -->
              <div>
                <div class="flex justify-between items-center mb-2">
                  <span class="font-medium text-gray-700">è®¡ç®—æœºåŸºç¡€</span>
                  <span class="text-sm text-gray-500">75%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                  <div class="bg-orange-600 h-2.5 rounded-full" style="width: 75%"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„æ¨è -->
        <div class="bg-white shadow rounded-lg overflow-hidden">
          <div class="px-4 py-5 border-b border-gray-200 sm:px-6">
            <h3 class="text-lg leading-6 font-medium text-gray-900 flex items-center">
              <i class="fa fa-lightbulb-o text-yellow-500 mr-2"></i>
              ä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„æ¨è
            </h3>
          </div>
          <div class="px-4 py-5 sm:p-6">
            <div class="mb-4">
              <p class="text-gray-600 mb-4">åŸºäºä½ çš„å­¦ä¹ æ•°æ®å’Œæµ‹éªŒè¡¨ç°ï¼Œæˆ‘ä»¬ä¸ºä½ æ¨èäº†ä»¥ä¸‹å­¦ä¹ è·¯å¾„ï¼š</p>
              
              <div class="border border-gray-200 rounded-lg p-4 bg-blue-50 mb-4">
                <div class="flex items-center mb-2">
                  <span class="bg-blue-500 text-white text-xs font-bold px-2.5 py-0.5 rounded-full mr-2">é‡ç‚¹æ¨è</span>
                  <h4 class="font-medium text-gray-900">ä»£æ•°åŸºç¡€å·©å›º</h4>
                </div>
                <p class="text-sm text-gray-700 mb-3">æ ¹æ®ä½ çš„æµ‹éªŒç»“æœï¼Œæˆ‘ä»¬å‘ç°ä½ åœ¨ä»£æ•°éƒ¨åˆ†å­˜åœ¨çŸ¥è¯†è–„å¼±ç‚¹ï¼Œå»ºè®®ä¼˜å…ˆå·©å›ºè¿™éƒ¨åˆ†å†…å®¹ã€‚</p>
                <button class="recommendation-button data-course-id="math-101" inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                  <i class="fa fa-road mr-2"></i>
                  æŸ¥çœ‹è¯¦ç»†å­¦ä¹ è·¯å¾„
                </button>
              </div>
              
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="border border-gray-200 rounded-lg p-4">
                  <h4 class="font-medium text-gray-900 mb-2">å¾®åˆ†æ–¹ç¨‹ä¸“é¢˜</h4>
                  <p class="text-sm text-gray-700 mb-3">è¿›ä¸€æ­¥å­¦ä¹ å¾®åˆ†æ–¹ç¨‹çš„è§£æ³•å’Œåº”ç”¨ï¼Œæå‡ä½ çš„æ•°å­¦åº”ç”¨èƒ½åŠ›ã€‚</p>
                  <button class="inline-flex items-center px-3 py-1 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    <i class="fa fa-book mr-2"></i>
                    å¼€å§‹å­¦ä¹ 
                  </button>
                </div>
                
                <div class="border border-gray-200 rounded-lg p-4">
                  <h4 class="font-medium text-gray-900 mb-2">æ¦‚ç‡è®ºä¹ é¢˜é›†</h4>
                  <p class="text-sm text-gray-700 mb-3">é€šè¿‡ä¹ é¢˜å·©å›ºæ¦‚ç‡è®ºçŸ¥è¯†ï¼Œæé«˜è§£é¢˜èƒ½åŠ›å’Œåº”è¯•æŠ€å·§ã€‚</p>
                  <button class="inline-flex items-center px-3 py-1 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    <i class="fa fa-pencil mr-2"></i>
                    å¼€å§‹ç»ƒä¹ 
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- å³ä¾§ï¼šæœ€è¿‘æ´»åŠ¨å’Œå­¦ä¹ ç»Ÿè®¡ -->
      <div class="space-y-6">
        <!-- å­¦ä¹ é£é™©é¢„æµ‹ -->
        <div class="bg-white shadow rounded-lg overflow-hidden">
          <div class="px-4 py-5 border-b border-gray-200 sm:px-6">
            <h3 class="text-lg leading-6 font-medium text-gray-900 flex items-center">
              <i class="fa fa-bar-chart text-primary mr-2"></i>
              å­¦ä¹ é£é™©é¢„æµ‹
            </h3>
          </div>
          <div class="px-4 py-5 sm:p-6">
            <div class="flex items-center justify-center mb-4">
              <div class="relative">
                <svg class="w-40 h-40" viewBox="0 0 100 100">
                  <!-- èƒŒæ™¯åœ†ç¯ -->
                  <circle cx="50" cy="50" r="45" fill="none" stroke="#e2e8f0" stroke-width="10"></circle>
                  <!-- è¿›åº¦åœ†ç¯ -->
                  <circle cx="50" cy="50" r="45" fill="none" stroke="#fbbf24" stroke-width="10" stroke-dasharray="283" stroke-dashoffset="184"></circle>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                  <div class="text-center">
                    <div class="text-3xl font-bold text-gray-900">35%</div>
                    <div class="text-sm text-gray-500">æŒ‚ç§‘é£é™©</div>
                  </div>
                </div>
              </div>
            </div>
            <p class="text-gray-600 text-center mb-4">ä¸­ç­‰é£é™©ï¼šå»ºè®®å¢åŠ å­¦ä¹ æ—¶é—´ï¼ŒåŠæ—¶å®Œæˆä½œä¸š</p>
            <button class="risk-prediction-button data-student-id="1001" w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-yellow-600 hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500">
              <i class="fa fa-exclamation-triangle mr-2"></i>
              æŸ¥çœ‹è¯¦ç»†åˆ†æ
            </button>
          </div>
        </div>
        
        <!-- æœ€è¿‘æ´»åŠ¨ -->
        <div class="bg-white shadow rounded-lg overflow-hidden">
          <div class="px-4 py-5 border-b border-gray-200 sm:px-6">
            <h3 class="text-lg leading-6 font-medium text-gray-900 flex items-center">
              <i class="fa fa-list-ul text-primary mr-2"></i>
              æœ€è¿‘æ´»åŠ¨
            </h3>
          </div>
          <div class="px-4 py-5 sm:p-6">
            <div class="space-y-4">
              <div class="flex">
                <div class="flex-shrink-0 flex items-center">
                  <div class="h-8 w-8 rounded-full bg-green-100 flex items-center justify-center">
                    <i class="fa fa-check text-green-600"></i>
                  </div>
                </div>
                <div class="ml-4">
                  <p class="text-sm text-gray-900">å®Œæˆäº†é«˜ç­‰æ•°å­¦ä½œä¸š #3</p>
                  <p class="text-xs text-gray-500">ä»Šå¤© 10:23</p>
                </div>
              </div>
              
              <div class="flex">
                <div class="flex-shrink-0 flex items-center">
                  <div class="h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center">
                    <i class="fa fa-play text-blue-600"></i>
                  </div>
                </div>
                <div class="ml-4">
                  <p class="text-sm text-gray-900">è§‚çœ‹äº†çº¿æ€§ä»£æ•°è§†é¢‘ï¼šçŸ©é˜µçš„ç§©</p>
                  <p class="text-xs text-gray-500">æ˜¨å¤© 16:45</p>
                </div>
              </div>
              
              <div class="flex">
                <div class="flex-shrink-0 flex items-center">
                  <div class="h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center">
                    <i class="fa fa-graduation-cap text-purple-600"></i>
                  </div>
                </div>
                <div class="ml-4">
                  <p class="text-sm text-gray-900">å‚åŠ äº†æ¦‚ç‡è®ºæµ‹éªŒï¼Œå¾—åˆ† 92/100</p>
                  <p class="text-xs text-gray-500">å‰å¤© 14:10</p>
                </div>
              </div>
              
              <div class="flex">
                <div class="flex-shrink-0 flex items-center">
                  <div class="h-8 w-8 rounded-full bg-yellow-100 flex items-center justify-center">
                    <i class="fa fa-bell text-yellow-600"></i>
                  </div>
                </div>
                <div class="ml-4">
                  <p class="text-sm text-gray-900">æ”¶åˆ°æ–°çš„ä½œä¸šé€šçŸ¥ï¼šé«˜ç­‰æ•°å­¦ä½œä¸š #4</p>
                  <p class="text-xs text-gray-500">3å¤©å‰</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- å­¦ä¹ æ—¶é—´ç»Ÿè®¡ -->
        <div class="bg-white shadow rounded-lg overflow-hidden">
          <div class="px-4 py-5 border-b border-gray-200 sm:px-6">
            <h3 class="text-lg leading-6 font-medium text-gray-900 flex items-center">
              <i class="fa fa-clock-o text-primary mr-2"></i>
              å­¦ä¹ æ—¶é—´ç»Ÿè®¡
            </h3>
          </div>
          <div class="px-4 py-5 sm:p-6">
            <div class="mb-4">
              <div class="flex justify-between items-center mb-2">
                <span class="font-medium text-gray-700">æœ¬å‘¨å­¦ä¹ æ—¶é•¿</span>
                <span class="text-sm font-semibold text-gray-900">12.5å°æ—¶</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div class="bg-green-600 h-2.5 rounded-full" style="width: 70%"></div>
              </div>
              <p class="text-xs text-gray-500 mt-1">ç›®æ ‡ï¼š18å°æ—¶</p>
            </div>
            
            <div class="space-y-3">
              <div class="flex justify-between items-center">
                <span class="text-sm text-gray-600">é«˜ç­‰æ•°å­¦</span>
                <span class="text-sm text-gray-600">4.5å°æ—¶</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-gray-600">çº¿æ€§ä»£æ•°</span>
                <span class="text-sm text-gray-600">3.2å°æ—¶</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-gray-600">æ¦‚ç‡è®º</span>
                <span class="text-sm text-gray-600">2.8å°æ—¶</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-gray-600">è®¡ç®—æœºåŸºç¡€</span>
                <span class="text-sm text-gray-600">2.0å°æ—¶</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- é¡µè„š -->
  <footer class="bg-white border-t border-gray-200 mt-8">
    <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
      <p class="text-center text-sm text-gray-500">
        Â© 2025 ä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„çš„åœ¨çº¿è¯¾ç¨‹ç®¡ç†ç³»ç»Ÿ | ç‰ˆæƒæ‰€æœ‰
      </p>
    </div>
  </footer>

  <!-- æ¨¡æ€æ¡†ï¼šå­¦ä¹ è·¯å¾„æ¨è -->
  <div id="recommendation-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">ä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„æ¨è</h4>
        <button class="modal-close text-gray-400 hover:text-gray-500">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
      </div>
      <div class="modal-footer">
        <button class="modal-close px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
          å…³é—­
        </button>
        <button class="px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
          é‡‡çº³æ¨è
        </button>
      </div>
    </div>
  </div>

  <!-- æ¨¡æ€æ¡†ï¼šå­¦ä¹ é£é™©é¢„æµ‹ -->
  <div id="risk-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">å­¦ä¹ é£é™©é¢„æµ‹åˆ†æ</h4>
        <button class="modal-close text-gray-400 hover:text-gray-500">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
      </div>
      <div class="modal-footer">
        <button class="modal-close px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
          å…³é—­
        </button>
        <button class="px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
          è·å–è¾…å¯¼
        </button>
      </div>
    </div>
  </div>

  <!-- æ¨¡æ€æ¡†ï¼šæ™ºèƒ½ç­”ç–‘æœºå™¨äºº -->
  <div id="chat-bot-modal" class="modal">
    <div class="modal-content" style="max-width: 450px;">
      <div class="modal-header">
        <h4 class="modal-title">æ™ºèƒ½å­¦ä¹ åŠ©æ‰‹</h4>
        <button class="modal-close text-gray-400 hover:text-gray-500">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="modal-body" style="padding: 0;">
        <div class="chat-container h-[400px] overflow-y-auto p-4 space-y-3">
          <!-- èŠå¤©å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
        </div>
        <div class="border-t p-3 flex">
          <input type="text" class="chat-input flex-1 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-primary focus:border-primary" placeholder="è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„ï¼Ÿ">
          <button class="chat-send px-4 py-2 bg-primary text-white rounded-r-md hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
            <i class="fa fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- å¼•å…¥JavaScript -->
  <script src="../assets/js/backend.js"></script>
  <script src="../assets/js/script.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
      if (!backend.isLoggedIn()) {
        window.location.href = 'login.html';
        return;
      }
      
      const user = backend.getCurrentUser();
      
      // æ¬¢è¿ä¿¡æ¯æ›´æ–°
      const welcomeMessage = document.querySelector('h1.text-2xl');
      if (welcomeMessage && user && user.name) {
        welcomeMessage.textContent = `ä½ å¥½ï¼Œ${user.name}ï¼ğŸ‘‹`;
      }
      
      // æ›´æ–°ç”¨æˆ·å¤´åƒå’Œåç§°
      const userAvatar = document.querySelector('img.h-8.w-8.rounded-full');
      const userName = document.querySelector('span.ml-2.text-sm.font-medium');
      if (userAvatar && userName && user && user.name) {
        userName.textContent = user.name;
      }
      
      // åŠ è½½å­¦ç”Ÿæ•°æ®
      if (user && user.id) {
        loadStudentData(user.id);
        
        // åŠ è½½å­¦ä¹ è¿›åº¦
        loadLearningProgress(user.id);
      }
      
      // å­¦ä¹ è·¯å¾„æ¨èæŒ‰é’®äº‹ä»¶
      const recommendationButton = document.querySelector('.recommendation-button');
      if (recommendationButton) {
        recommendationButton.addEventListener('click', function() {
          // å‡è®¾ç‚¹å‡»é«˜ç­‰æ•°å­¦è¯¾ç¨‹çš„æ¨è
          showLearningPathRecommendation(user.id, 1);
        });
      }
      
      // å­¦ä¹ é£é™©é¢„æµ‹æŒ‰é’®äº‹ä»¶
      const riskPredictionButton = document.querySelector('.risk-prediction-button');
      if (riskPredictionButton) {
        riskPredictionButton.addEventListener('click', function() {
          showRiskPrediction(user.id);
        });
      }
      
      // æ™ºèƒ½åŠ©æ‰‹æŒ‰é’®äº‹ä»¶
      const chatBotButton = document.querySelector('.chat-bot-button');
      if (chatBotButton) {
        chatBotButton.addEventListener('click', function() {
          openChatBot();
        });
      }
      
      // ç™»å‡ºåŠŸèƒ½
      const userProfile = document.querySelector('.flex.items-center .ml-3.relative');
      if (userProfile) {
        userProfile.addEventListener('click', function() {
          if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
            backend.logout();
            window.location.href = 'login.html';
          }
        });
      }
    });
    
    // åŠ è½½å­¦ç”Ÿæ•°æ®
    async function loadStudentData(studentId) {
      try {
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        showLoadingState(true);
        
        // å¹¶è¡ŒåŠ è½½å¤šç§æ•°æ®
        const [coursesResult, assignmentsResult, gradesResult] = await Promise.all([
          backend.getCourses(studentId, 'student'),
          backend.getAssignments(null, studentId, 'student'),
          backend.getGrades(studentId)
        ]);
        
        if (coursesResult.success && assignmentsResult.success && gradesResult.success) {
          const courses = coursesResult.data;
          const assignments = assignmentsResult.data;
          const grades = gradesResult.data;
          
          // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
          updateStatisticsCards(courses, assignments, grades);
          
          // æ›´æ–°å­¦ä¹ æ—¶é—´ç»Ÿè®¡
          updateStudyTimeStatistics(courses);
          
          // æ›´æ–°æœ€è¿‘æ´»åŠ¨
          updateRecentActivities();
        } else {
          console.error('Failed to load student data');
        }
      } catch (error) {
        console.error('Error loading student data:', error);
      } finally {
        // éšè—åŠ è½½çŠ¶æ€
        showLoadingState(false);
      }
    }
    
    // åŠ è½½å­¦ä¹ è¿›åº¦
    async function loadLearningProgress(studentId) {
      try {
        const progressResult = await backend.getProgress(studentId);
        
        if (progressResult.success) {
          const progressData = progressResult.data;
          
          // æ›´æ–°å­¦ä¹ è¿›åº¦æ¦‚è§ˆ
          updateLearningProgressOverview(progressData);
        } else {
          console.error('Failed to load learning progress');
        }
      } catch (error) {
        console.error('Error loading learning progress:', error);
      }
    }
    
    // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
    function updateStatisticsCards(courses, assignments, grades) {
      // è¯¾ç¨‹æ€»æ•°
      const totalCoursesElement = document.querySelector('.dashboard-card:nth-child(1) .text-lg.font-semibold');
      if (totalCoursesElement) {
        totalCoursesElement.textContent = courses.length;
      }
      
      // è¿›è¡Œä¸­è¯¾ç¨‹
      const activeCoursesElement = document.querySelector('.dashboard-card:nth-child(2) .text-lg.font-semibold');
      if (activeCoursesElement) {
        const activeCourses = courses.filter(course => course.completedChapters < course.totalChapters);
        activeCoursesElement.textContent = activeCourses.length;
      }
      
      // å¾…å®Œæˆä½œä¸š
      const pendingAssignmentsElement = document.querySelector('.dashboard-card:nth-child(3) .text-lg.font-semibold');
      if (pendingAssignmentsElement) {
        const pendingAssignments = assignments.filter(assignment => 
          assignment.status === 'active' && (!assignment.submission || assignment.submission.status !== 'graded')
        );
        pendingAssignmentsElement.textContent = pendingAssignments.length;
      }
      
      // å¹³å‡æˆç»©
      const averageGradeElement = document.querySelector('.dashboard-card:nth-child(4) .text-lg.font-semibold');
      if (averageGradeElement && grades.length > 0) {
        const totalScore = grades.reduce((sum, grade) => sum + grade.score, 0);
        const averageScore = (totalScore / grades.length).toFixed(1);
        averageGradeElement.textContent = averageScore;
      }
    }
    
    // æ›´æ–°å­¦ä¹ è¿›åº¦æ¦‚è§ˆ
    function updateLearningProgressOverview(progressData) {
      const progressContainer = document.querySelector('.space-y-6');
      if (progressContainer && progressData.length > 0) {
        // æ¸…ç©ºç°æœ‰å†…å®¹
        progressContainer.innerHTML = '';
        
        // ä¸ºæ¯ä¸ªè¯¾ç¨‹åˆ›å»ºè¿›åº¦æ¡
        progressData.forEach(progress => {
          // æ‰¾åˆ°å¯¹åº”çš„è¯¾ç¨‹
          const course = backend.mockData.courses.find(c => c.id === progress.courseId);
          if (course) {
            const progressBar = document.createElement('div');
            progressBar.className = 'mb-4';
            progressBar.innerHTML = `
              <div class="flex justify-between items-center mb-2">
                <span class="font-medium text-gray-700">${course.name}</span>
                <span class="text-sm text-gray-500">${progress.overallProgress}%</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div class="h-2.5 rounded-full" style="width: ${progress.overallProgress}%; background-color: ${getProgressColor(progress.overallProgress)}"></div>
              </div>
            `;
            
            progressContainer.appendChild(progressBar);
          }
        });
      }
    }
    
    // è·å–è¿›åº¦æ¡é¢œè‰²
    function getProgressColor(progress) {
      if (progress < 30) return '#ef4444'; // çº¢è‰²
      if (progress < 70) return '#f59e0b'; // é»„è‰²
      return '#10b981'; // ç»¿è‰²
    }
    
    // æ›´æ–°å­¦ä¹ æ—¶é—´ç»Ÿè®¡
    function updateStudyTimeStatistics(courses) {
      // æ¨¡æ‹Ÿå­¦ä¹ æ—¶é—´æ•°æ®
      const studyTimeData = {
        total: 12.5,
        target: 18,
        courses: [
          { name: 'é«˜ç­‰æ•°å­¦', hours: 4.5 },
          { name: 'çº¿æ€§ä»£æ•°', hours: 3.2 },
          { name: 'æ¦‚ç‡è®º', hours: 2.8 },
          { name: 'è®¡ç®—æœºåŸºç¡€', hours: 2.0 }
        ]
      };
      
      // æ›´æ–°æ€»å­¦ä¹ æ—¶é•¿
      const totalHoursElement = document.querySelector('.text-sm.font-semibold.text-gray-900');
      const progressBarFill = document.querySelector('.bg-green-600.h-2.5.rounded-full');
      const targetText = document.querySelector('.text-xs.text-gray-500');
      
      if (totalHoursElement && progressBarFill && targetText) {
        totalHoursElement.textContent = `${studyTimeData.total}å°æ—¶`;
        const progressPercentage = Math.min(100, (studyTimeData.total / studyTimeData.target) * 100);
        progressBarFill.style.width = `${progressPercentage}%`;
        targetText.textContent = `ç›®æ ‡ï¼š${studyTimeData.target}å°æ—¶`;
      }
      
      // æ›´æ–°å„è¯¾ç¨‹å­¦ä¹ æ—¶é—´
      const coursesTimeList = document.querySelector('.space-y-3');
      if (coursesTimeList) {
        coursesTimeList.innerHTML = '';
        
        studyTimeData.courses.forEach(course => {
          const timeItem = document.createElement('div');
          timeItem.className = 'flex justify-between items-center';
          timeItem.innerHTML = `
            <span class="text-sm text-gray-600">${course.name}</span>
            <span class="text-sm text-gray-600">${course.hours}å°æ—¶</span>
          `;
          
          coursesTimeList.appendChild(timeItem);
        });
      }
    }
    
    // æ›´æ–°æœ€è¿‘æ´»åŠ¨
    function updateRecentActivities() {
      // æ¨¡æ‹Ÿæœ€è¿‘æ´»åŠ¨æ•°æ®
      const recentActivities = [
        { type: 'completed', message: 'å®Œæˆäº†é«˜ç­‰æ•°å­¦ä½œä¸š #3', time: 'ä»Šå¤© 10:23', icon: 'check', color: 'green' },
        { type: 'watched', message: 'è§‚çœ‹äº†çº¿æ€§ä»£æ•°è§†é¢‘ï¼šçŸ©é˜µçš„ç§©', time: 'æ˜¨å¤© 16:45', icon: 'play', color: 'blue' },
        { type: 'graded', message: 'å‚åŠ äº†æ¦‚ç‡è®ºæµ‹éªŒï¼Œå¾—åˆ† 92/100', time: 'å‰å¤© 14:10', icon: 'graduation-cap', color: 'purple' },
        { type: 'notified', message: 'æ”¶åˆ°æ–°çš„ä½œä¸šé€šçŸ¥ï¼šé«˜ç­‰æ•°å­¦ä½œä¸š #4', time: '3å¤©å‰', icon: 'bell', color: 'yellow' }
      ];
      
      const activitiesContainer = document.querySelector('.space-y-4');
      if (activitiesContainer) {
        activitiesContainer.innerHTML = '';
        
        recentActivities.forEach(activity => {
          const activityItem = document.createElement('div');
          activityItem.className = 'flex';
          activityItem.innerHTML = `
            <div class="flex-shrink-0 flex items-center">
              <div class="h-8 w-8 rounded-full bg-${activity.color}-100 flex items-center justify-center">
                <i class="fa fa-${activity.icon} text-${activity.color}-600"></i>
              </div>
            </div>
            <div class="ml-4">
              <p class="text-sm text-gray-900">${activity.message}</p>
              <p class="text-xs text-gray-500">${activity.time}</p>
            </div>
          `;
          
          activitiesContainer.appendChild(activityItem);
        });
      }
    }
    
    // æ˜¾ç¤ºå­¦ä¹ è·¯å¾„æ¨è
    async function showLearningPathRecommendation(studentId, courseId) {
      try {
        const result = await backend.getLearningPath(courseId, studentId);
        
        if (result.success) {
          const recommendation = result.data;
          
          // è·å–æ¨¡æ€æ¡†
          const modal = document.getElementById('recommendation-modal');
          const modalBody = modal.querySelector('.modal-body');
          
          if (modalBody) {
            // å¡«å……æ¨¡æ€æ¡†å†…å®¹
            modalBody.innerHTML = `
              <div class="mb-4">
                <h5 class="text-lg font-medium text-gray-900 mb-2">${recommendation.courseName} - ä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„</h5>
                <p class="text-gray-600">å½“å‰å­¦ä¹ è¿›åº¦: <span class="font-medium text-primary">${recommendation.overallProgress}%</span></p>
              </div>
              
              ${recommendation.weakChapters.length > 0 ? `
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                  <h6 class="text-sm font-medium text-yellow-800">è–„å¼±ç« èŠ‚</h6>
                  <p class="text-sm text-yellow-700 mt-1">å»ºè®®é‡ç‚¹å¤ä¹ ä»¥ä¸‹ç« èŠ‚: ${recommendation.weakChapters.join(', ')}ç« </p>
                </div>
              ` : ''}
              
              <div class="mb-4">
                <h6 class="text-sm font-medium text-gray-900 mb-2">æ¨èå­¦ä¹ é¡ºåº</h6>
                <ol class="space-y-2">
                  ${recommendation.recommendedOrder.map((item, index) => `
                    <li class="flex items-start">
                      <span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full mt-0.5">${index + 1}</span>
                      <div>
                        <p class="text-sm text-gray-900">ç¬¬${item.chapter}ç« </p>
                        <p class="text-xs text-gray-500">${item.reason}</p>
                      </div>
                    </li>
                  `).join('')}
                </ol>
              </div>
              
              <div>
                <h6 class="text-sm font-medium text-gray-900 mb-2">æ¨èå­¦ä¹ èµ„æº</h6>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                  ${recommendation.resources.map(resource => `
                    <div class="bg-gray-50 border border-gray-200 rounded-md p-3 flex items-center">
                      <i class="fa fa-${getResourceIcon(resource.type)} text-primary mr-2"></i>
                      <div>
                        <p class="text-sm text-gray-900">${resource.title}</p>
                        <p class="text-xs text-gray-500">${getResourceDetails(resource)}</p>
                      </div>
                    </div>
                  `).join('')}
                </div>
              </div>
            `;
          }
          
          // æ˜¾ç¤ºæ¨¡æ€æ¡†
          modal.style.display = 'flex';
        }
      } catch (error) {
        console.error('Error loading learning path recommendation:', error);
        alert('åŠ è½½å­¦ä¹ è·¯å¾„æ¨èå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
      }
    }
    
    // è·å–èµ„æºå›¾æ ‡
    function getResourceIcon(type) {
      const icons = {
        'video': 'play-circle',
        'document': 'file-text-o',
        'exercise': 'pencil',
        'quiz': 'check-square-o'
      };
      return icons[type] || 'book';
    }
    
    // è·å–èµ„æºè¯¦æƒ…
    function getResourceDetails(resource) {
      if (resource.duration) return resource.duration;
      if (resource.pages) return resource.pages;
      if (resource.questions) return resource.questions;
      return 'å­¦ä¹ èµ„æº';
    }
    
    // æ˜¾ç¤ºå­¦ä¹ é£é™©é¢„æµ‹
    async function showRiskPrediction(studentId) {
      try {
        // å‡è®¾æ£€æŸ¥ç¬¬ä¸€é—¨è¯¾ç¨‹çš„é£é™©
        const result = await backend.predictLearningRisk(studentId, 1);
        
        if (result.success) {
          const riskData = result.data;
          
          // è·å–æ¨¡æ€æ¡†
          const modal = document.getElementById('risk-modal');
          const modalBody = modal.querySelector('.modal-body');
          
          if (modalBody) {
            // å¡«å……æ¨¡æ€æ¡†å†…å®¹
            modalBody.innerHTML = `
              <div class="flex justify-center mb-6">
                <div class="relative w-32 h-32">
                  <svg class="w-full h-full" viewBox="0 0 100 100">
                    <!-- èƒŒæ™¯åœ†ç¯ -->
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#e2e8f0" stroke-width="10"></circle>
                    <!-- è¿›åº¦åœ†ç¯ -->
                    <circle cx="50" cy="50" r="45" fill="none" stroke="${getRiskColor(riskData.riskLevel)}" stroke-width="10" stroke-dasharray="283" stroke-dashoffset="${283 - (riskData.riskPercentage / 100 * 283)}"></circle>
                  </svg>
                  <div class="absolute inset-0 flex items-center justify-center">
                    <div class="text-center">
                      <div class="text-2xl font-bold text-gray-900">${riskData.riskPercentage}%</div>
                      <div class="text-xs text-gray-500">æŒ‚ç§‘é£é™©</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="mb-4">
                <p class="text-center text-gray-600 mb-2">${getRiskLevelText(riskData.riskLevel)}</p>
                <div class="grid grid-cols-2 gap-4 text-center">
                  <div class="bg-gray-50 p-2 rounded-md">
                    <p class="text-xs text-gray-500">å¹³å‡æˆç»©</p>
                    <p class="text-lg font-medium text-gray-900">${riskData.avgScore}</p>
                  </div>
                  <div class="bg-gray-50 p-2 rounded-md">
                    <p class="text-xs text-gray-500">å­¦ä¹ è¿›åº¦</p>
                    <p class="text-lg font-medium text-gray-900">${riskData.progress}%</p>
                  </div>
                </div>
              </div>
              
              ${riskData.riskFactors.length > 0 ? `
                <div class="mb-4">
                  <h6 class="text-sm font-medium text-gray-900 mb-2">é£é™©å› ç´ </h6>
                  <ul class="list-disc pl-5 space-y-1">
                    ${riskData.riskFactors.map(factor => `<li class="text-sm text-gray-700">${factor}</li>`).join('')}
                  </ul>
                </div>
              ` : ''}
              
              <div>
                <h6 class="text-sm font-medium text-gray-900 mb-2">å­¦ä¹ å»ºè®®</h6>
                <ul class="list-disc pl-5 space-y-1">
                  ${riskData.recommendations.map(recommendation => `<li class="text-sm text-gray-700">${recommendation}</li>`).join('')}
                </ul>
              </div>
            `;
          }
          
          // æ˜¾ç¤ºæ¨¡æ€æ¡†
          modal.style.display = 'flex';
        }
      } catch (error) {
        console.error('Error loading risk prediction:', error);
        alert('åŠ è½½å­¦ä¹ é£é™©é¢„æµ‹å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
      }
    }
    
    // è·å–é£é™©ç­‰çº§é¢œè‰²
    function getRiskColor(riskLevel) {
      const colors = {
        'low': '#10b981', // ç»¿è‰²
        'medium': '#f59e0b', // é»„è‰²
        'high': '#ef4444' // çº¢è‰²
      };
      return colors[riskLevel] || '#9ca3af';
    }
    
    // è·å–é£é™©ç­‰çº§æ–‡æœ¬
    function getRiskLevelText(riskLevel) {
      const texts = {
        'low': 'ä½é£é™©ï¼šä¿æŒå½“å‰å­¦ä¹ çŠ¶æ€ï¼Œç»§ç»­åŠ æ²¹ï¼',
        'medium': 'ä¸­ç­‰é£é™©ï¼šå»ºè®®å¢åŠ å­¦ä¹ æ—¶é—´ï¼ŒåŠæ—¶å®Œæˆä½œä¸š',
        'high': 'é«˜é£é™©ï¼šéœ€è¦ç«‹å³é‡‡å–è¡ŒåŠ¨ï¼Œå¯»æ±‚æ•™å¸ˆå¸®åŠ©'
      };
      return texts[riskLevel] || 'é£é™©è¯„ä¼°ï¼šæš‚æ— æ•°æ®';
    }
    
    // æ‰“å¼€æ™ºèƒ½åŠ©æ‰‹
    function openChatBot() {
      const modal = document.getElementById('chat-bot-modal');
      const chatContainer = modal.querySelector('.chat-container');
      const chatInput = modal.querySelector('.chat-input');
      const chatSend = modal.querySelector('.chat-send');
      
      // æ¸…ç©ºèŠå¤©è®°å½•
      if (chatContainer) {
        chatContainer.innerHTML = '';
        
        // æ·»åŠ æ¬¢è¿æ¶ˆæ¯
        addBotMessage('ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„æ™ºèƒ½å­¦ä¹ åŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ');
      }
      
      // æ˜¾ç¤ºæ¨¡æ€æ¡†
      modal.style.display = 'flex';
      
      // å‘é€æ¶ˆæ¯äº‹ä»¶
      if (chatSend && chatInput) {
        chatSend.addEventListener('click', function() {
          sendChatMessage();
        });
        
        // å›è½¦å‘é€
        chatInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            sendChatMessage();
          }
        });
      }
      
      // å‘é€æ¶ˆæ¯å‡½æ•°
      async function sendChatMessage() {
        const message = chatInput.value.trim();
        if (!message) return;
        
        // æ¸…ç©ºè¾“å…¥æ¡†
        chatInput.value = '';
        
        // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
        addUserMessage(message);
        
        try {
          // è·å–æœºå™¨äººå›å¤
          const result = await backend.askQuestion(message, backend.getCurrentUser().id);
          
          if (result.success) {
            // æ·»åŠ æœºå™¨äººå›å¤
            setTimeout(() => {
              addBotMessage(result.data.answer);
            }, 500);
          }
        } catch (error) {
          console.error('Error getting chatbot response:', error);
          addBotMessage('æŠ±æ­‰ï¼Œæˆ‘ç°åœ¨æ— æ³•å›ç­”ä½ çš„é—®é¢˜ï¼Œè¯·ç¨åå†è¯•ã€‚');
        }
      }
      
      // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
      function addUserMessage(message) {
        const messageElement = document.createElement('div');
        messageElement.className = 'flex justify-end';
        messageElement.innerHTML = `
          <div class="bg-primary text-white p-2 rounded-l-lg rounded-tr-lg max-w-[80%]">
            <p class="text-sm">${message}</p>
          </div>
        `;
        chatContainer.appendChild(messageElement);
        chatContainer.scrollTop = chatContainer.scrollHeight;
      }
      
      // æ·»åŠ æœºå™¨äººæ¶ˆæ¯
      function addBotMessage(message) {
        const messageElement = document.createElement('div');
        messageElement.className = 'flex';
        messageElement.innerHTML = `
          <div class="bg-gray-100 p-2 rounded-r-lg rounded-tl-lg max-w-[80%]">
            <p class="text-sm text-gray-800">${message}</p>
          </div>
        `;
        chatContainer.appendChild(messageElement);
        chatContainer.scrollTop = chatContainer.scrollHeight;
      }
    }
    
    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    function showLoadingState(show) {
      const mainContent = document.querySelector('main');
      let loadingElement = document.getElementById('loading-overlay');
      
      if (show) {
        if (!loadingElement) {
          loadingElement = document.createElement('div');
          loadingElement.id = 'loading-overlay';
          loadingElement.className = 'fixed inset-0 bg-white bg-opacity-80 z-50 flex items-center justify-center';
          loadingElement.innerHTML = `
            <div class="text-center">
              <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div>
              <p class="mt-4 text-gray-600">åŠ è½½ä¸­...</p>
            </div>
          `;
          document.body.appendChild(loadingElement);
        } else {
          loadingElement.style.display = 'flex';
        }
        
        if (mainContent) {
          mainContent.style.opacity = '0.5';
        }
      } else {
        if (loadingElement) {
          loadingElement.style.display = 'none';
        }
        
        if (mainContent) {
          mainContent.style.opacity = '1';
        }
      }
    }
    
    // æ¨¡æ€æ¡†å…³é—­äº‹ä»¶
    document.querySelectorAll('.modal-close').forEach(button => {
      button.addEventListener('click', function() {
        const modal = this.closest('.modal');
        if (modal) {
          modal.style.display = 'none';
        }
      });
    });
    
    // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
    window.addEventListener('click', function(event) {
      document.querySelectorAll('.modal').forEach(modal => {
        if (event.target === modal) {
          modal.style.display = 'none';
        }
      });
    });
  </script>
</body>
</html>